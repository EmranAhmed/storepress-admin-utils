(()=>{"use strict";(()=>{const e=window.StorePress.Utils,t=(0,e.createStorePressPlugin)({selector:"[data-storepress-tooltip]",options:{},plugin:function(e){const t=()=>{this.$element.style.removeProperty("--_tooltip-position")},i=()=>{this.$element.classList.remove("storepress-tooltip-position-top","storepress-tooltip-position-bottom","ios-safari-hover")},s=()=>{this.controller.abort()},n=()=>{t(),i();const e=this.$element.getBoundingClientRect(),s=window.getComputedStyle(this.$element),n=window.getComputedStyle(this.$element,"::before");let o=parseInt(n.getPropertyValue("width"),10),r=parseInt(n.getPropertyValue("height"),10);const l=parseInt(s.getPropertyValue("--tooltip-angle"),10),E=parseInt(s.getPropertyValue("--tooltip-edge"),10),a=parseInt(s.getPropertyValue("--tooltip-offset"),10),h=parseInt(s.getPropertyValue("--tooltip-padding"),10);if(isNaN(r)){const{height:e,width:t}=(e=>{const t=document.createElement("div"),i=window.getComputedStyle(e,"::before"),s=i.getPropertyValue("content").match(/attr\(([^)]+)\)/),n=!!s&&s[1];t.textContent=n?e.getAttribute(n):"",t.style.position="absolute",t.style.display="block",t.style.visibility="hidden",t.style.height=i.height,t.style.width=i.width,t.style.padding=i.padding,t.style.margin=i.margin,t.style.border=i.border,t.style.boxSizing=i.boxSizing,t.style.fontSize=i.fontSize,t.style.lineHeight=i.lineHeight,t.style.maxWidth=i.maxWidth,t.style.miHeight=i.miHeight,document.body.appendChild(t);const o={height:t.offsetHeight,width:t.offsetWidth};return document.body.removeChild(t),o})(this.$element);r=e-h,o=t-h}const p=r+l+E+a+h;this.$element.classList.toggle("storepress-tooltip-position-bottom",e.top<p),this.$element.classList.toggle("storepress-tooltip-position-top",e.top>p);const u=o/2,c=e.left+e.width/2,d=u-c,R=u>c,A=u+c,g=document.documentElement.clientWidth<A,m=document.documentElement.clientWidth-A;if(R){const e=this.isRTL?-1*(d+E):d+E;this.$element.style.setProperty("--_tooltip-position",`${e}px`)}if(g){const e=this.isRTL?-1*(m-E):m-E;this.$element.style.setProperty("--_tooltip-position",`${e}px`)}},o=()=>{t(),i(),s()},r=()=>{(()=>{const e=window.navigator.userAgent,t=new RegExp("iPad|iPhone|iPod","i").test(e),i=new RegExp("WebKit","i").test(e),s=new RegExp("CriOS","i").test(e);return t&&i&&!s})()&&(this.$element.addEventListener("touchstart",()=>{this.$element.classList.add("ios-safari-hover")},{signal:this.signal,passive:!0}),document.addEventListener("touchstart",e=>{this.$element.contains(e.target)||this.$element.classList.remove("ios-safari-hover")},{signal:this.signal,passive:!0})),this.$element.addEventListener("pointerenter",n,{signal:this.signal,passive:!0}),this.$element.hasAttribute("tabindex")&&this.$element.addEventListener("focusin",n,{signal:this.signal,passive:!0}),this.isImageTooltip&&this.$element.classList.add("storepress-tooltip-type-image")};return(()=>(this.$element=e,this.isRTL=!!this.$element.closest('[dir="rtl"]')?.dir,this.controller=new AbortController,this.signal=this.controller.signal,this.isImageTooltip=this.$element.style.getPropertyValue("--tooltip-image").length>0,r(),{reset:o}))()},namespace:"tooltip"});t.setup();const i=t,s=(0,e.createStorePressPlugin)({selector:"[data-storepress-conditional-field]",options:{},plugin:function(t,i){const s={},n={COMPARE_OPERATOR:{KEY:"compare",DEFAULT:"EQ",AVAILABLE:{EQ:["EQUAL","=","EQ","SAME"],GT:["GREATER THAN",">","GT"],LT:["LESS THAN","<","LT"],GTEQ:["GREATER THAN OR EQUAL",">=","GTEQ"],LTEQ:["LESS THAN OR EQUAL","<=","LTEQ"],INCLUDES:["HAS","INCLUDES","CONTAINS","IN","LIKE"]}},TYPE_OPERATOR:{KEY:"type",DEFAULT:"BOOLEAN",AVAILABLE:["STRING","STRING-ARRAY","NUMBER","NUMBER-ARRAY","BOOLEAN","RANGE","MINMAX","ELEMENT","REGEXP"]},FUNCTIONS_FOR_TYPE:{BOOLEAN:"EXISTS",STRING:"STRING","STRING-ARRAY":"STRING-ARRAY",NUMBER:"NUMBER","NUMBER-ARRAY":"NUMBER-ARRAY",ELEMENT:"ELEMENT",MINMAX:"MINMAX",RANGE:"RANGE",REGEXP:"REGEXP"},RELATION_OPERATOR:{DEFAULT:"AND",KEY:"relation",AVAILABLE:["AND","OR"]},SELECTOR_OPERATOR:{KEY:"selector"},VALUE_OPERATOR:{KEY:"value",DEFAULT:!0},INERT_OPERATOR:{KEY:"inert",DEFAULT:!1},STRICT_OPERATOR:{KEY:"strict",DEFAULT:!1},CASE_SENSITIVITY_OPERATOR:{KEY:"case",DEFAULT:!1},ELEMENT_CHECK_FN:{KEY:"check",DEFAULT:"STRING",AVAILABLE:["STRING","STRING-ARRAY","NUMBER","NUMBER-ARRAY","RANGE","MINMAX","VISIBLE"]},REQUIRE_OPERATOR:{KEY:"require",DEFAULT:!1},FN_OPERATOR:{KEY:"fn"},EVENTS:["input"]},o={relation:n.RELATION_OPERATOR.DEFAULT,disableInertInput:!0,readOnlyInertInput:!1,inertInput:"input, select, textarea"},r=e=>n.FUNCTIONS_FOR_TYPE[e],l=()=>n.CASE_SENSITIVITY_OPERATOR.KEY,E=()=>n.ELEMENT_CHECK_FN.KEY,a=()=>n.FN_OPERATOR.KEY,h=()=>n.VALUE_OPERATOR.KEY,p=()=>n.REQUIRE_OPERATOR.KEY,u=()=>n.TYPE_OPERATOR.KEY,c=()=>n.INERT_OPERATOR.KEY,d=()=>n.STRICT_OPERATOR.KEY,R=()=>n.COMPARE_OPERATOR.KEY,A=e=>e[p()],g=(e,t)=>{e[p()]=t},m=(e,t)=>{e[a()]=t},T=e=>e[n.SELECTOR_OPERATOR.KEY],y=e=>e[l()],N=e=>e[E()],I=e=>e[h()],L=e=>e[u()],O=(e,t)=>{e[u()]=t},S=e=>e[c()],f=(e,t)=>{e[c()]=t},v=e=>{const t=e[R()];return Object.keys(n.COMPARE_OPERATOR.AVAILABLE).find(e=>n.COMPARE_OPERATOR.AVAILABLE[e].includes(t))},w=e=>e[d()],P=e=>e.type.toUpperCase(),U=(e,t)=>{const i=[],s=[];let n=0;const o=[],r=t.split(","),l=[],E=new Set,a=new Set;return e.forEach(t=>{const h=P(t),p=t.name,u=r.find(e=>t.matches(e));if("SELECT-MULTIPLE"===h){const e=Array.from(t.selectedOptions).filter(e=>e.value.length>0).map(e=>e.value);s.push(...e),i.push(`INPUT:${h}`),o.push(e.length>0),n+=e.length,l.push({input:e,length:e.length,multiple:!0,type:h,selector:t})}if("CHECKBOX"===h&&!a.has(u)){i.push(`INPUT:${h}`);const r=Array.from(e).filter(e=>e.matches(u)&&"CHECKBOX"===P(e)).filter(e=>e.checked&&e.value.length>0).map(e=>e.value);s.push(...r),o.push(r.length>0),n+=r.length,l.push({input:r,length:r.length,multiple:!0,type:h,selector:t}),a.add(u)}if("RADIO"===h&&!E.has(p)){i.push(`INPUT:${h}`);const r=Array.from(e).filter(e=>e.name===p&&"RADIO"===P(e)).find(e=>e.checked&&e.value.length>0),a=r?r.value:"";s.push(a),o.push(a.length>0),n+=a.length,l.push({input:a.length>0?[a]:[],length:a.length,multiple:!1,type:h,selector:t}),E.add(p)}if(!["SELECT-MULTIPLE","CHECKBOX","RADIO"].includes(h)){i.push(`INPUT:${h}`);const e=t.value.length>0?t.value:"";s.push(e),o.push(e.length>0),n+=e.length,l.push({input:e.length>0?[e]:[],length:e.length,multiple:!1,type:h,selector:t})}}),{inputs:i,values:s,count:n,empty:!o.every(e=>e),notEmpty:o.every(e=>e),map:l}},_=(e,t,i=!1,s=!1)=>{if(i)return s?e.toString().includes(t):e.includes(t);const n=RegExp.escape(t),o=s?new RegExp(`\\b${n}\\b`,"ui"):new RegExp(`^${n}$`,"ui");return e.some(e=>o.test(e))},M=(e,t,i=!1,s=!1)=>!(!Array.isArray(e)||!Array.isArray(t))&&(i?s?t.every(t=>e.includes(t)):e.every(e=>t.includes(e)):s?t.every(t=>{const i=RegExp.escape(t),s=new RegExp(`\\b${i}\\b`,"ui");return e.some(e=>s.test(e))}):e.every(e=>{const i=RegExp.escape(e),s=new RegExp(`^${i}$`,"ui");return t.some(e=>s.test(e))})),b=(e,t,i=!1,s=!1)=>!(!Array.isArray(e)||!Array.isArray(t))&&(i?s?t.some(t=>e.includes(t)):e.some(e=>t.includes(e)):s?t.some(t=>{const i=RegExp.escape(t),s=new RegExp(`\\b${i}\\b`,"ui");return e.some(e=>s.test(e))}):e.some(e=>{const i=RegExp.escape(e),s=new RegExp(`^${i}$`,"ui");return t.some(e=>s.test(e))})),$={EXISTS:e=>{this.showField=S(e);const t=T(e),i=document.querySelectorAll(t),{notEmpty:s}=U(i,t);s&&(this.showField=!S(e))},STRING:e=>{this.showField=S(e);const t=I(e),i=w(e),s=y(e),n=T(e),o=document.querySelectorAll(n),{notEmpty:r,map:l}=U(o,n),E="INCLUDES"===v(e);r&&l.every(({input:e,multiple:n,length:o})=>n?((e,t,i,s,n,o)=>s?1===t&&((e,t,i=!1,s=!1)=>{if(i)return s?e.toString().includes(t):e.includes(t);const n=RegExp.escape(t),o=s?new RegExp(`\\b${n}\\b`,"ui"):new RegExp(`^${n}$`,"ui");return e.every(e=>o.test(e))})(e,i,n,o):_(e,i,n,o))(e,o,t,i,s,E):_(e,t,s,E))&&(this.showField=!S(e))},NUMBER:e=>{this.showField=S(e);const t=Number(I(e)),i=v(e),s=T(e),n=document.querySelectorAll(s),{notEmpty:o,map:r}=U(n,s);o&&r.every(({length:e})=>"EQ"===i&&e===t||"GT"===i&&e>t||"GTEQ"===i&&e>=t||"LT"===i&&e<t||"LTEQ"===i&&e<=t)&&(this.showField=!S(e))},"STRING-ARRAY":e=>{this.showField=S(e);const t=I(e),i=w(e),s=A(e),n=y(e),o=T(e),r=document.querySelectorAll(o),l="INCLUDES"===v(e),{notEmpty:E,map:a}=U(r,o);if(E){const o=a.every(({input:e,multiple:o})=>o?((e,t,i,s,n,o)=>i?e.length===t.length&&M(t,e,n,o):s?M(t,e,n,o):b(t,e,n,o))(e,t,i,s,n,l):b(e,t,n,l));o&&(this.showField=!S(e))}},"NUMBER-ARRAY":e=>{this.showField=S(e);const t=I(e),i=T(e),s=document.querySelectorAll(i),{notEmpty:n,map:o}=U(s,i);n&&o.every(({length:e})=>t.includes(e))&&(this.showField=!S(e))},MINMAX:e=>{this.showField=S(e);const t=I(e),[i=0,s=Number.MAX_SAFE_INTEGER]=t,n=T(e),o=document.querySelectorAll(n),{notEmpty:r,map:l}=U(o,n);r&&l.every(({length:e})=>i<=e&&s>=e)&&(this.showField=!S(e))},RANGE:e=>{this.showField=S(e);const t=I(e),i=T(e),s=document.querySelectorAll(i),[n=0,o=Number.MAX_SAFE_INTEGER]=t,{notEmpty:r,map:l}=U(s,i);r&&l.every(({input:e,selector:t})=>["RANGE","NUMBER"].includes(P(t))&&n<=Number(e.at(0))&&o>=Number(e.at(0)))&&(this.showField=!S(e))},REGEXP:e=>{this.showField=S(e);const t=I(e),i=T(e),s=document.querySelectorAll(i),{notEmpty:n,map:o}=U(s,i),r=(e=>{const[t,i,s]=e.match(/^\/(.+)\/([gimsuyx]*)$/);return{pattern:i,flags:s,_:t}})(t),l=w(e);n&&o.every(({input:e,multiple:t})=>t?l?e.every(e=>new RegExp(r.pattern,r.flags).test(e)):e.some(e=>new RegExp(r.pattern,r.flags).test(e)):e.every(e=>new RegExp(r.pattern,r.flags).test(e)))&&(this.showField=!S(e))},VISIBLE:e=>{this.showField=S(e);const t=w(e),i=I(e),s=document.querySelectorAll(i),n=[];s.forEach(e=>{n.push(e.checkVisibility())}),t&&n.every(e=>e)&&(this.showField=!S(e)),!t&&n.some(e=>e)&&(this.showField=!S(e))},ELEMENT:e=>{const t=N(e);if(!n.ELEMENT_CHECK_FN.AVAILABLE.includes(t))return;if(["VISIBLE"].includes(t)){const i={...e};return void $[`${t}`](i)}const i=I(e),s=document.querySelectorAll(i),{map:o}=U(s,i),r=o.some(({multiple:e})=>!0===e)||o.length>1,l=r?o.reduce((e,{input:i,length:s})=>(["RANGE","MINMAX"].includes(t)?e.push(...i.map(e=>Number(e))):"NUMBER"===t?e.push(s):e.push(...i),e),[]):o.reduce((e,{input:i,length:s,type:n})=>{const o=i.at(0);return"NUMBER"===t?["NUMBER","RANGE"].includes(n)?o??0:s:o??""},""),E=["STRING","NUMBER"].includes(t)&&r?"-ARRAY":"",a={...e,[h()]:l};$[`${t}${E}`](a)}},F=(e=!0)=>{const t=this.$element.querySelectorAll(this.settings.inertInput);!0===e?(this.$element.setAttribute("inert",""),this.settings.disableInertInput&&t.forEach(e=>e.disabled=!0),this.settings.readOnlyInertInput&&t.forEach(e=>e.readOnly=!0)):(this.$element.removeAttribute("inert"),this.settings.disableInertInput&&t.forEach(e=>e.disabled=!1),this.settings.readOnlyInertInput&&t.forEach(e=>e.readOnly=!1))},C=(e,t)=>{const i=(e=>e[a()])(e);if("function"!=typeof $[i])throw new Error('Compare function "'+i+'" not available.');$[i](e,t),this.matched.set(e.selector,this.showField),"AND"===this.relation&&([...this.matched.values()].every(e=>!0===e)?F(!1):F(!0)),"OR"===this.relation&&([...this.matched.values()].some(e=>!0===e)?F(!1):F(!0))},Y=()=>{F(!0),this.showField=!1,this.conditions=[],this.matched=new Map,this.controller.abort()},B=e=>{if(delete e[a()],void 0===v(e)&&((e,t)=>{e[R()]=t})(e,n.COMPARE_OPERATOR.DEFAULT),void 0===N(e)&&((e,t)=>{e[E()]=t})(e,n.ELEMENT_CHECK_FN.DEFAULT),void 0===w(e)&&((e,t)=>{e[d()]=t})(e,n.STRICT_OPERATOR.DEFAULT),void 0===A(e)&&g(e,n.REQUIRE_OPERATOR.DEFAULT),!0===w(e)&&g(e,!1),void 0===y(e)&&((e,t)=>{e[l()]=t})(e,n.CASE_SENSITIVITY_OPERATOR.DEFAULT),void 0===S(e)&&f(e,n.INERT_OPERATOR.DEFAULT),void 0===L(e)&&O(e,n.TYPE_OPERATOR.DEFAULT),void 0===I(e)&&((e,t)=>{e[h()]=t})(e,n.VALUE_OPERATOR.DEFAULT),"boolean"==typeof I(e)&&(O(e,"BOOLEAN"),!1===I(e)&&f(e,!0),m(e,r(L(e)))),"string"==typeof I(e)&&(["ELEMENT"].includes(L(e))||O(e,"STRING"),m(e,r(L(e)))),"number"==typeof I(e)&&(O(e,"NUMBER"),m(e,r(L(e)))),(e=>"object"==typeof e[h()]&&Array.isArray(e[h()]))(e)){if(["ELEMENT"].includes(L(e)))return["MINMAX","RANGE"].includes(N(e))?m(e,"NUMBER-ARRAY"):m(e,"STRING-ARRAY"),e;I(e).every(e=>"number"==typeof e)?(["MINMAX","RANGE"].includes(L(e))||O(e,"NUMBER-ARRAY"),m(e,r(L(e)))):(O(e,"STRING-ARRAY"),m(e,r(L(e))))}var t;return"string"==typeof(t=I(e))&&new RegExp("/(.+)/([gimsuyx]*)").test(t)&&(O(e,"REGEXP"),m(e,r(L(e)))),e},x=()=>{for(const e in this.settings)if(!isNaN(e)){const t=this.settings[e];this.conditions.push(B(t))}if(this.conditions.length<1){const e=this.settings;this.conditions.push(B(e))}},G=()=>this.conditions,D=()=>{const e=G();e.forEach(e=>{this.matched.set(e.selector,!1)}),e.forEach(e=>{if("ELEMENT"===L(e)){const t=I(e),i=document.querySelectorAll(t);i.forEach(t=>{n.EVENTS.forEach(s=>{t.addEventListener(s,()=>{C(e,i)},{signal:this.signal,passive:!0})}),C(e,i)})}const t=T(e),i=document.querySelectorAll(t);i.forEach(t=>{n.EVENTS.forEach(s=>{t.addEventListener(s,()=>{C(e,i)},{signal:this.signal,passive:!0})}),C(e,i)}),this.$parent.length>0&&this.$parent.addEventListener("reset",((e,t)=>()=>{setTimeout(()=>{C(e,t)},1)})(e,i),{signal:this.signal,passive:!0})})};return(()=>(this.$element=t,this.settings={...o,...i,...(0,e.getOptionsFromAttribute)(this.$element,"storepress-conditional-field",{parseNumber:!1,parseBoolean:!1,parseRegex:!1}),...s},this.relation=this.settings.relation,this.showField=!1,this.conditions=[],this.$parent=this.$element.closest("form"),this.matched=new Map,this.controller=new AbortController,this.signal=this.controller.signal,x(),D(),{reset:Y}))()},namespace:"conditional"});s.setup();const n=s;!function(e,t){const s={init(){this.promptBeforeExit(),this.initTooltip(),this.initUnitInput(),this.initConditionalField()},handleBeforeTabSwitch:e=>(e.preventDefault(),e.returnValue=t.unsaved_warning_text,t.unsaved_warning_text),promptBeforeExit(){let i=!1;e.document.querySelectorAll('input:not(.ignore-change):not([type="hidden"]):not([type="submit"]), select:not(.ignore-change), textarea:not(.ignore-change)').forEach(t=>{t.addEventListener("input",()=>{i||(i=!0,e.addEventListener("beforeunload",this.handleBeforeTabSwitch))})}),document.querySelectorAll('input[type="submit"], .storepress-settings-reset-action-link').forEach(i=>{i.addEventListener("click",i=>{if(e.removeEventListener("beforeunload",this.handleBeforeTabSwitch),i.target.classList.contains("storepress-settings-reset-action-link")&&!e.confirm(t.reset_warning_text))return i.preventDefault(),!1})})},initTooltip(){i.init()},initConditionalField(){n.init()},initUnitInput(){document.querySelectorAll(".unit-input-container").forEach(e=>{const t=e.querySelector(".input-unit-value"),i=e.querySelector(".input-field input"),s=e.querySelector(".input-unit select"),n=e.querySelector(".input-suffix");i.addEventListener("input",e=>{const i=e.target.value,o=s?s.value:n.textContent;t.value=`${i}${o}`}),s?.addEventListener("input",e=>{const s=e.target.value,n=i.value;t.value=`${n}${s}`})})}};document.addEventListener("DOMContentLoaded",()=>{s.init()})}(window,window.STOREPRESS_ADMIN_UTILS_SETTINGS_PARAMS)})()})();